{
  "task_id": "user_permission_audit",
  "task_name": "User Permission Audit",
  "category_id": "security",
  "category_name": "Security",
  "description": "Conduct comprehensive security audit identifying users with insufficient or dangling permissions in business database environment.",
  "author": "Fanshi Zhang",
  "created_at": "2025-08-17",
  "difficulty": "L3",
  "tags": [
    "security and access control",
    "audit and compliance"
  ],
  "mcp": [
    "postgres"
  ],
  "meta_data": {
    "stateType": "text",
    "stateContent": "Table \"user_profiles\" {\n  \"user_id\" int4 [pk, not null, increment]\n  \"username\" varchar(50) [unique, not null]\n  \"email\" varchar(100) [unique, not null]\n  \"first_name\" varchar(50) [not null]\n  \"last_name\" varchar(50) [not null]\n  \"phone\" varchar(20)\n  \"address\" text\n  \"city\" varchar(50)\n  \"state\" varchar(2)\n  \"zip_code\" varchar(10)\n  \"date_created\" timestamp [default: `CURRENT_TIMESTAMP`]\n  \"last_updated\" timestamp [default: `CURRENT_TIMESTAMP`]\n  \"is_active\" bool [default: true]\n  \"profile_picture_url\" text\n  \"bio\" text\n}\n\nTable \"user_credentials\" {\n  \"credential_id\" int4 [pk, not null, increment]\n  \"user_id\" int4\n  \"password_hash\" varchar(255) [not null]\n  \"salt\" varchar(100) [not null]\n  \"login_attempts\" int4 [default: 0]\n  \"last_login\" timestamp\n  \"password_created\" timestamp [default: `CURRENT_TIMESTAMP`]\n  \"password_expires\" timestamp\n  \"is_locked\" bool [default: false]\n  \"two_factor_enabled\" bool [default: false]\n  \"two_factor_secret\" varchar(32)\n  \"backup_codes\" \"text[]\"\n  \"security_questions\" jsonb\n}\n\nTable \"user_stat_analysis\" {\n  \"analysis_id\" int4 [pk, not null, increment]\n  \"user_id\" int4\n  \"session_id\" varchar(100)\n  \"page_views\" int4 [default: 0]\n  \"time_spent_minutes\" int4 [default: 0]\n  \"actions_performed\" jsonb\n  \"device_info\" jsonb\n  \"ip_address\" inet\n  \"location_data\" jsonb\n  \"referrer_url\" text\n  \"conversion_events\" jsonb\n  \"analysis_date\" date [default: `CURRENT_DATE`]\n  \"created_at\" timestamp [default: `CURRENT_TIMESTAMP`]\n}\n\nTable \"product_catalog\" {\n  \"product_id\" int4 [pk, not null, increment]\n  \"product_name\" varchar(100) [not null]\n  \"description\" text\n  \"category\" varchar(50)\n  \"price\" numeric(10,2) [not null]\n  \"cost\" numeric(10,2)\n  \"sku\" varchar(50) [unique]\n  \"inventory_count\" int4 [default: 0]\n  \"is_active\" bool [default: true]\n  \"created_at\" timestamp [default: `CURRENT_TIMESTAMP`]\n  \"updated_at\" timestamp [default: `CURRENT_TIMESTAMP`]\n  \"supplier_info\" jsonb\n  \"weight_kg\" numeric(6,2)\n  \"dimensions\" jsonb\n}\n\nTable \"order_management\" {\n  \"order_id\" int4 [pk, not null, increment]\n  \"user_id\" int4\n  \"order_number\" varchar(50) [unique, not null]\n  \"order_status\" varchar(20) [default: 'pending']\n  \"total_amount\" numeric(12,2) [not null]\n  \"tax_amount\" numeric(12,2)\n  \"shipping_amount\" numeric(12,2)\n  \"discount_amount\" numeric(12,2) [default: 0]\n  \"payment_method\" varchar(50)\n  \"payment_status\" varchar(20) [default: 'pending']\n  \"shipping_address\" jsonb\n  \"billing_address\" jsonb\n  \"order_date\" timestamp [default: `CURRENT_TIMESTAMP`]\n  \"shipped_date\" timestamp\n  \"delivered_date\" timestamp\n  \"tracking_number\" varchar(100)\n}\n\nTable \"financial_transactions\" {\n  \"transaction_id\" int4 [pk, not null, increment]\n  \"order_id\" int4\n  \"user_id\" int4\n  \"transaction_type\" varchar(20) [not null]\n  \"amount\" numeric(12,2) [not null]\n  \"currency\" varchar(3) [default: 'USD']\n  \"payment_gateway\" varchar(50)\n  \"gateway_transaction_id\" varchar(100)\n  \"credit_card_last_four\" bpchar(4)\n  \"bank_account_last_four\" bpchar(4)\n  \"transaction_status\" varchar(20) [default: 'pending']\n  \"processed_at\" timestamp\n  \"created_at\" timestamp [default: `CURRENT_TIMESTAMP`]\n  \"fee_amount\" numeric(8,2)\n  \"refund_amount\" numeric(12,2) [default: 0]\n  \"notes\" text\n}\n\nTable \"audit_logs\" {\n  \"log_id\" int4 [pk, not null, increment]\n  \"user_id\" int4\n  \"action_type\" varchar(50) [not null]\n  \"table_name\" varchar(50)\n  \"record_id\" int4\n  \"old_values\" jsonb\n  \"new_values\" jsonb\n  \"ip_address\" inet\n  \"user_agent\" text\n  \"session_id\" varchar(100)\n  \"timestamp\" timestamp [default: `CURRENT_TIMESTAMP`]\n  \"success\" bool [default: true]\n  \"error_message\" text\n}\n\nRef \"audit_logs_user_id_fkey\":\"user_profiles\".\"user_id\" < \"audit_logs\".\"user_id\"\n\nRef \"financial_transactions_order_id_fkey\":\"order_management\".\"order_id\" < \"financial_transactions\".\"order_id\"\n\nRef \"financial_transactions_user_id_fkey\":\"user_profiles\".\"user_id\" < \"financial_transactions\".\"user_id\"\n\nRef \"order_management_user_id_fkey\":\"user_profiles\".\"user_id\" < \"order_management\".\"user_id\"\n\nRef \"user_credentials_user_id_fkey\":\"user_profiles\".\"user_id\" < \"user_credentials\".\"user_id\" [delete: cascade]\n\nRef \"user_stat_analysis_user_id_fkey\":\"user_profiles\".\"user_id\" < \"user_stat_analysis\".\"user_id\" [delete: cascade]\n",
    "stateUrl": null,
    "stateOriginalUrl": null
  }
}